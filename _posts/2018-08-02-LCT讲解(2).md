---
layout: post
title:  "LCT讲解"
date:   2018-08-03 15:34:05
categories: C++ LCT
tags: C++ LCT
---

* content
{:toc}


<div id="main">
	<div id="mainContent">
	<div class="forFlow">
		
<div id="post_detail">
<!--done-->
<div id="topics">
	<div class="post">
		<h1 class="postTitle">
			<a id="cb_post_title_url" class="postTitle2" href="https://www.cnblogs.com/flashhu/p/8324551.html">LCT总结+题单+洛谷P3690[模板]Link Cut Tree(动态树)(LCT,Splay)</a>
		</h1>
		<div class="clear"></div>
		<div class="postBody">
			<div id="cnblogs_post_body" class="blogpost-body cnblogs-markdown"><h1 id="概念性质简述">概念、性质简述</h1>
<p>首先介绍一下<strong>链剖分</strong>的概念（感谢laofu的讲课）<br>
链剖分，是指一类对树的边进行轻重划分的操作，这样做的目的是为了减少某些链上的修改、查询等操作的复杂度。<br>
目前总共有三类：重链剖分，实链剖分和并不常见的长链剖分</p>







<h3 id="重链剖分">重链剖分</h3>
<p>实际上我们经常讲的树剖，就是重链剖分的常用称呼。<br>
对于每个点，选择最大的子树，将这条连边划分为重边，而连向其他子树的边划分为轻边。<br>
若干重边连接在一起构成重链，用树状数组或线段树等静态数据结构维护。<br>
至于有怎样优秀的性质等等，不在本总结的讨论范畴了（其实是因为本蒟蒻连树剖都不会）</p>
<h3 id="实链剖分">实链剖分</h3>
<p>同样将某一个儿子的连边划分为实边，而连向其他子树的边划分为虚边。<br>
区别在于虚实是可以动态变化的，因此要使用更高级、更灵活的Splay来维护每一条由若干实边连接而成的实链。<br>
基于性质更加优秀的实链剖分，LCT(Link-Cut Tree)应运而生。<br>
LCT维护的对象其实是一个森林。<br>
在实链剖分的基础下，LCT资磁更多的操作</p>
<ul>
<li>查询、修改链上的信息（最值，总和等）</li>
<li>随意指定原树的根（即换根）</li>
<li>动态连边、删边</li>
<li>合并两棵树、分离一棵树（<del>跟上面不是一毛一样吗</del>）</li>
<li>动态维护连通性</li>
<li>更多意想不到的操作（可以往下滑一滑）</li>
</ul>
<p>想学Splay的话，推荐<a href="http://www.cnblogs.com/cjyyb/p/7499020.html">巨佬yyb的博客</a></p>
<hr>
<p>LCT的主要性质如下：</p>
<ol>
<li><p>每一个Splay维护的是一条从上到下按在原树中深度严格递增的路径，且中序遍历Splay得到的每个点的深度序列严格递增。<br>
<del>是不是有点抽象哈</del><br>
比如有一棵树，根节点为<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-1-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-1" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.534em, 1000.43em, 2.5em, -1000em); top: -2.35em; left: 0em;"><span class="mrow" id="MathJax-Span-2"><span class="mn" id="MathJax-Span-3" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.958em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-1">1</script></span>（深度1），有两个儿子<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-2-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn><mo>,</mo><mn>3</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-4" style="width: 1.852em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.45em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.534em, 1001.41em, 2.694em, -1000em); top: -2.35em; left: 0em;"><span class="mrow" id="MathJax-Span-5"><span class="mn" id="MathJax-Span-6" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-7" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-8" style="font-family: MathJax_Main; padding-left: 0.167em;">3</span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 1.2em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn><mo>,</mo><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-2">2,3</script></span>（深度2），那么Splay有<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-3-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>3</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-9" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.535em, 1000.46em, 2.522em, -1000em); top: -2.35em; left: 0em;"><span class="mrow" id="MathJax-Span-10"><span class="mn" id="MathJax-Span-11" style="font-family: MathJax_Main;">3</span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.09em; border-left: 0px solid; width: 0px; height: 0.984em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-3">3</script></span>种构成方式：<br>
<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-4-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>1</mn><mo>&amp;#x2212;</mo><mn>2</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo><mo>,</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>3</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-12" style="width: 6.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.15em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.45em, 1005.08em, 2.75em, -1000em); top: -2.35em; left: 0em;"><span class="mrow" id="MathJax-Span-13"><span class="mo" id="MathJax-Span-14" style="font-family: MathJax_Main;">{</span><span class="mn" id="MathJax-Span-15" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-16" style="font-family: MathJax_Main; padding-left: 0.222em;">?</span><span class="mn" id="MathJax-Span-17" style="font-family: MathJax_Main; padding-left: 0.222em;">2</span><span class="mo" id="MathJax-Span-18" style="font-family: MathJax_Main;">}</span><span class="mo" id="MathJax-Span-19" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-20" style="font-family: MathJax_Main; padding-left: 0.167em;">{</span><span class="mn" id="MathJax-Span-21" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-22" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.375em; border-left: 0px solid; width: 0px; height: 1.375em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>?</mo><mn>2</mn><mo fence="false" stretchy="false">}</mo><mo>,</mo><mo fence="false" stretchy="false">{</mo><mn>3</mn><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-4">\{1-2\},\{3\}</script></span><br>
<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-5-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>1</mn><mo>&amp;#x2212;</mo><mn>3</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo><mo>,</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>2</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-23" style="width: 6.453em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.15em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.45em, 1005.08em, 2.75em, -1000em); top: -2.35em; left: 0em;"><span class="mrow" id="MathJax-Span-24"><span class="mo" id="MathJax-Span-25" style="font-family: MathJax_Main;">{</span><span class="mn" id="MathJax-Span-26" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-27" style="font-family: MathJax_Main; padding-left: 0.222em;">?</span><span class="mn" id="MathJax-Span-28" style="font-family: MathJax_Main; padding-left: 0.222em;">3</span><span class="mo" id="MathJax-Span-29" style="font-family: MathJax_Main;">}</span><span class="mo" id="MathJax-Span-30" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-31" style="font-family: MathJax_Main; padding-left: 0.167em;">{</span><span class="mn" id="MathJax-Span-32" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-33" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.375em; border-left: 0px solid; width: 0px; height: 1.375em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo>?</mo><mn>3</mn><mo fence="false" stretchy="false">}</mo><mo>,</mo><mo fence="false" stretchy="false">{</mo><mn>2</mn><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-5">\{1-3\},\{2\}</script></span><br>
<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-6-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>1</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo><mo>,</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>2</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo><mo>,</mo><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>{</mo><mn>3</mn><mo fence=&quot;false&quot; stretchy=&quot;false&quot;>}</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-34" style="width: 6.753em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.4em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.45em, 1005.33em, 2.75em, -1000em); top: -2.35em; left: 0em;"><span class="mrow" id="MathJax-Span-35"><span class="mo" id="MathJax-Span-36" style="font-family: MathJax_Main;">{</span><span class="mn" id="MathJax-Span-37" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-38" style="font-family: MathJax_Main;">}</span><span class="mo" id="MathJax-Span-39" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-40" style="font-family: MathJax_Main; padding-left: 0.167em;">{</span><span class="mn" id="MathJax-Span-41" style="font-family: MathJax_Main;">2</span><span class="mo" id="MathJax-Span-42" style="font-family: MathJax_Main;">}</span><span class="mo" id="MathJax-Span-43" style="font-family: MathJax_Main;">,</span><span class="mo" id="MathJax-Span-44" style="font-family: MathJax_Main; padding-left: 0.167em;">{</span><span class="mn" id="MathJax-Span-45" style="font-family: MathJax_Main;">3</span><span class="mo" id="MathJax-Span-46" style="font-family: MathJax_Main;">}</span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.375em; border-left: 0px solid; width: 0px; height: 1.375em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mo fence="false" stretchy="false">{</mo><mn>1</mn><mo fence="false" stretchy="false">}</mo><mo>,</mo><mo fence="false" stretchy="false">{</mo><mn>2</mn><mo fence="false" stretchy="false">}</mo><mo>,</mo><mo fence="false" stretchy="false">{</mo><mn>3</mn><mo fence="false" stretchy="false">}</mo></math></span></span><script type="math/tex" id="MathJax-Element-6">\{1\},\{2\},\{3\}</script></span>（每个集合表示一个Splay）<br>
而不能把<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-7-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-47" style="width: 3.002em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.4em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.534em, 1002.36em, 2.694em, -1000em); top: -2.35em; left: 0em;"><span class="mrow" id="MathJax-Span-48"><span class="mn" id="MathJax-Span-49" style="font-family: MathJax_Main;">1</span><span class="mo" id="MathJax-Span-50" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-51" style="font-family: MathJax_Main; padding-left: 0.167em;">2</span><span class="mo" id="MathJax-Span-52" style="font-family: MathJax_Main;">,</span><span class="mn" id="MathJax-Span-53" style="font-family: MathJax_Main; padding-left: 0.167em;">3</span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.305em; border-left: 0px solid; width: 0px; height: 1.2em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mn>3</mn></math></span></span><script type="math/tex" id="MathJax-Element-7">1,2,3</script></span>同放在一个Splay中（存在深度相同的点）</p></li>
<li><p>每个节点包含且仅包含于一个Splay中</p></li>
<li><p>边分为实边和虚边，实边包含在Splay中，而虚边总是由一棵Splay指向另一个节点（指向该Splay中中序遍历最靠前的点在原树中的父亲）。<br>
因为性质2，当某点在原树中有多个儿子时，只能向其中一个儿子拉一条实链（只认一个儿子），而其它儿子是不能在这个Splay中的。<br>
那么为了保持树的形状，我们要让到其它儿子的边变为虚边，由对应儿子所属的Splay的根节点的父亲指向该点，而从该点并不能直接访问该儿子（认父不认子）。</p></li>
</ol>
<h1 id="各种操作">各种操作</h1>
<h2 id="accessx"><span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-8-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-54" style="width: 5.179em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.141em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.509em, 1004.05em, 2.791em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-55"><span class="mi" id="MathJax-Span-56" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-57" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-58" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-59" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-60" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-61" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-62" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-63" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-64" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.371em; border-left: 0px solid; width: 0px; height: 1.368em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-8">access(x)</script></span></h2>
<p>LCT核心操作，也是最难理解的操作。其它所有的操作都是在此基础上完成的。<br>
因为性质3，我们不能总是保证两个点之间的路径是直接连通的（在一个Splay上）。<br>
access即定义为打通根节点到指定节点的实链，使得一条中序遍历以根开始、以指定点结束的Splay出现。<br>
<del>蒟蒻深知没图的痛苦qwq</del><br>
所以还是来几张图吧。<br>
下面的图片参考<a href="https://wenku.baidu.com/view/75906f160b4e767f5acfcedb">YangZhe的论文</a><br>
有一棵树，假设一开始实边和虚边是这样划分的（虚线为虚边）<br>
<img src="https://images2017.cnblogs.com/blog/1309909/201801/1309909-20180123095924037-1618037447.png"></p>
<p>那么所构成的LCT可能会长这样（绿框中为一个Splay，可能不会长这样，但只要满足中序遍历按深度递增（性质1）就对结果无影响）<br>
<img src="https://images2017.cnblogs.com/blog/1309909/201801/1309909-20180123095955350-1680422636.png"><br>
现在我们要<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-9-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-65" style="width: 5.603em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.45em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.5em, 1004.36em, 2.8em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-66"><span class="mi" id="MathJax-Span-67" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-68" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-69" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-70" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-71" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-72" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-73" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-74" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span class="mo" id="MathJax-Span-75" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.375em; border-left: 0px solid; width: 0px; height: 1.375em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-9">access(N)</script></span>，把<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-10-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo>&amp;#x2212;</mo><mi>N</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-76" style="width: 3.603em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.85em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.534em, 1002.85em, 2.632em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-77"><span class="mi" id="MathJax-Span-78" style="font-family: MathJax_Math; font-style: italic;">A</span><span class="mo" id="MathJax-Span-79" style="font-family: MathJax_Main; padding-left: 0.222em;">?</span><span class="mi" id="MathJax-Span-80" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.165em; border-left: 0px solid; width: 0px; height: 1.123em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>?</mo><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-10">A-N</script></span>的路径拉起来变成一条Splay。<br>
因为性质2，该路径上其它链都要给这条链让路，也就是把每个点到该路径以外的实边变虚。<br>
所以我们希望虚实边重新划分成这样。<br>
<img src="https://images2017.cnblogs.com/blog/1309909/201801/1309909-20180123101901740-2118178734.png"><br>
然后怎么实现呢？<br>
我们要一步步往上拉。<br>
首先把<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-11-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mi>N</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-81" style="width: 4.952em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.95em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.5em, 1003.86em, 2.8em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-82"><span class="mi" id="MathJax-Span-83" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-84" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-85" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-86" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-87" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-88" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-89" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span class="mo" id="MathJax-Span-90" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.375em; border-left: 0px solid; width: 0px; height: 1.375em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi><mo stretchy="false">(</mo><mi>N</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-11">splay(N)</script></span>，使之成为当前Splay中的根。<br>
为了满足性质2，原来<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-12-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi><mo>&amp;#x2212;</mo><mi>O</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-91" style="width: 3.603em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.85em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1002.83em, 2.632em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-92"><span class="mi" id="MathJax-Span-93" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span><span class="mo" id="MathJax-Span-94" style="font-family: MathJax_Main; padding-left: 0.222em;">?</span><span class="mi" id="MathJax-Span-95" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">O</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.165em; border-left: 0px solid; width: 0px; height: 1.107em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi><mo>?</mo><mi>O</mi></math></span></span><script type="math/tex" id="MathJax-Element-12">N-O</script></span>的重边要变轻。<br>
因为按深度<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-13-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-96" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.75em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1000.73em, 2.572em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-97"><span class="mi" id="MathJax-Span-98" style="font-family: MathJax_Math; font-style: italic;">O</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.09em; border-left: 0px solid; width: 0px; height: 1.032em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi></math></span></span><script type="math/tex" id="MathJax-Element-13">O</script></span>在<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-14-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-99" style="width: 1.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.9em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1000.9em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-100"><span class="mi" id="MathJax-Span-101" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-14">N</script></span>的下面，在Splay中<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-15-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>O</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-102" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.75em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.546em, 1000.73em, 2.572em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-103"><span class="mi" id="MathJax-Span-104" style="font-family: MathJax_Math; font-style: italic;">O</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.09em; border-left: 0px solid; width: 0px; height: 1.032em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>O</mi></math></span></span><script type="math/tex" id="MathJax-Element-15">O</script></span>在<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-16-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-105" style="width: 1.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.9em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1000.9em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-106"><span class="mi" id="MathJax-Span-107" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-16">N</script></span>的右子树中，所以直接单方面将<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-17-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-108" style="width: 1.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.9em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1000.9em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-109"><span class="mi" id="MathJax-Span-110" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-17">N</script></span>的右儿子置为<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-18-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>0</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-111" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.534em, 1000.46em, 2.522em, -1000em); top: -2.35em; left: 0em;"><span class="mrow" id="MathJax-Span-112"><span class="mn" id="MathJax-Span-113" style="font-family: MathJax_Main;">0</span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.09em; border-left: 0px solid; width: 0px; height: 0.985em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>0</mn></math></span></span><script type="math/tex" id="MathJax-Element-18">0</script></span>（认父不认子）<br>
然后就变成了这样——<br>
<img src="https://images2017.cnblogs.com/blog/1309909/201801/1309909-20180123110136115-1112016464.png"></p>
<p>我们接着把<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-19-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-114" style="width: 1.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.9em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1000.9em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-115"><span class="mi" id="MathJax-Span-116" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-19">N</script></span>所属Splay的虚边指向的<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-20-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-117" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1000.5em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-118"><span class="mi" id="MathJax-Span-119" style="font-family: MathJax_Math; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-20">I</script></span>（在原树上是<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-21-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-120" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.7em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1000.67em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-121"><span class="mi" id="MathJax-Span-122" style="font-family: MathJax_Math; font-style: italic;">L</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-21">L</script></span>的父亲）也转到它所属Splay的根，<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-22-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mi>I</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-123" style="width: 4.502em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.6em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.5em, 1003.51em, 2.8em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-124"><span class="mi" id="MathJax-Span-125" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-126" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-127" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-128" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-129" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-130" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-131" style="font-family: MathJax_Math; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-132" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.375em; border-left: 0px solid; width: 0px; height: 1.375em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi><mo stretchy="false">(</mo><mi>I</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-22">splay(I)</script></span>。<br>
原来在<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-23-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-133" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1000.5em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-134"><span class="mi" id="MathJax-Span-135" style="font-family: MathJax_Math; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-23">I</script></span>下方的重边<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-24-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi><mo>&amp;#x2212;</mo><mi>K</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-136" style="width: 3.252em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.6em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1002.6em, 2.632em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-137"><span class="mi" id="MathJax-Span-138" style="font-family: MathJax_Math; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-139" style="font-family: MathJax_Main; padding-left: 0.222em;">?</span><span class="mi" id="MathJax-Span-140" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">K<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.04em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.165em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi><mo>?</mo><mi>K</mi></math></span></span><script type="math/tex" id="MathJax-Element-24">I-K</script></span>要变轻（同样是将右儿子去掉）。<br>
这时候<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-25-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi><mo>&amp;#x2212;</mo><mi>L</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-141" style="width: 3.002em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.4em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1002.37em, 2.632em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-142"><span class="mi" id="MathJax-Span-143" style="font-family: MathJax_Math; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span><span class="mo" id="MathJax-Span-144" style="font-family: MathJax_Main; padding-left: 0.222em;">?</span><span class="mi" id="MathJax-Span-145" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">L</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.165em; border-left: 0px solid; width: 0px; height: 1.081em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi><mo>?</mo><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-25">I-L</script></span>就可以变重了。因为<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-26-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-146" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.7em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1000.67em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-147"><span class="mi" id="MathJax-Span-148" style="font-family: MathJax_Math; font-style: italic;">L</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-26">L</script></span>肯定是在<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-27-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-149" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1000.5em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-150"><span class="mi" id="MathJax-Span-151" style="font-family: MathJax_Math; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-27">I</script></span>下方的（刚才<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-28-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>L</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-152" style="width: 0.903em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.7em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1000.67em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-153"><span class="mi" id="MathJax-Span-154" style="font-family: MathJax_Math; font-style: italic;">L</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>L</mi></math></span></span><script type="math/tex" id="MathJax-Element-28">L</script></span>所属Splay指向了<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-29-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-155" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1000.5em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-156"><span class="mi" id="MathJax-Span-157" style="font-family: MathJax_Math; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-29">I</script></span>），所以I的右儿子置为<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-30-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>N</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-158" style="width: 1.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.9em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1000.9em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-159"><span class="mi" id="MathJax-Span-160" style="font-family: MathJax_Math; font-style: italic;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-30">N</script></span>，满足性质1。<br>
然后就变成了这样——<br>
<img src="https://images2017.cnblogs.com/blog/1309909/201801/1309909-20180123110156272-1242463729.png"></p>
<p><span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-31-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-161" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1000.5em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-162"><span class="mi" id="MathJax-Span-163" style="font-family: MathJax_Math; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-31">I</script></span>指向<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-32-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-164" style="width: 1.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.9em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1000.9em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-165"><span class="mi" id="MathJax-Span-166" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi></math></span></span><script type="math/tex" id="MathJax-Element-32">H</script></span>，接着<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-33-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mi>H</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-167" style="width: 4.952em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.95em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.5em, 1003.86em, 2.8em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-168"><span class="mi" id="MathJax-Span-169" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-170" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-171" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-172" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-173" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-174" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-175" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span><span class="mo" id="MathJax-Span-176" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.375em; border-left: 0px solid; width: 0px; height: 1.375em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi><mo stretchy="false">(</mo><mi>H</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-33">splay(H)</script></span>，<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-34-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-177" style="width: 1.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.9em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1000.9em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-178"><span class="mi" id="MathJax-Span-179" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi></math></span></span><script type="math/tex" id="MathJax-Element-34">H</script></span>的右儿子置为<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-35-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>I</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-180" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1000.5em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-181"><span class="mi" id="MathJax-Span-182" style="font-family: MathJax_Math; font-style: italic;">I<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.064em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>I</mi></math></span></span><script type="math/tex" id="MathJax-Element-35">I</script></span>。<br>
<img src="https://images2017.cnblogs.com/blog/1309909/201801/1309909-20180123110209772-2057141058.png"></p>
<p><span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-36-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-183" style="width: 1.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.9em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1000.9em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-184"><span class="mi" id="MathJax-Span-185" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi></math></span></span><script type="math/tex" id="MathJax-Element-36">H</script></span>指向<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-37-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-186" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.75em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.534em, 1000.73em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-187"><span class="mi" id="MathJax-Span-188" style="font-family: MathJax_Math; font-style: italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.02em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-37">A</script></span>，接着<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-38-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mi>A</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-189" style="width: 4.752em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.8em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.5em, 1003.71em, 2.8em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-190"><span class="mi" id="MathJax-Span-191" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-192" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-193" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-194" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-195" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-196" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-197" style="font-family: MathJax_Math; font-style: italic;">A</span><span class="mo" id="MathJax-Span-198" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.375em; border-left: 0px solid; width: 0px; height: 1.375em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi><mo stretchy="false">(</mo><mi>A</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-38">splay(A)</script></span>，<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-39-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-199" style="width: 0.953em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.75em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.534em, 1000.73em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-200"><span class="mi" id="MathJax-Span-201" style="font-family: MathJax_Math; font-style: italic;">A</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 1.02em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi></math></span></span><script type="math/tex" id="MathJax-Element-39">A</script></span>的右儿子置为<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-40-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>H</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-202" style="width: 1.153em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.9em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.567em, 1000.9em, 2.55em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-203"><span class="mi" id="MathJax-Span-204" style="font-family: MathJax_Math; font-style: italic;">H<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.057em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.979em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>H</mi></math></span></span><script type="math/tex" id="MathJax-Element-40">H</script></span>。<br>
<img src="https://images2017.cnblogs.com/blog/1309909/201801/1309909-20180123110213709-49169640.png"></p>
<p><span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-41-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>A</mi><mo>&amp;#x2212;</mo><mi>N</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-205" style="width: 3.603em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.85em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.534em, 1002.85em, 2.632em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-206"><span class="mi" id="MathJax-Span-207" style="font-family: MathJax_Math; font-style: italic;">A</span><span class="mo" id="MathJax-Span-208" style="font-family: MathJax_Main; padding-left: 0.222em;">?</span><span class="mi" id="MathJax-Span-209" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">N<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.085em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.165em; border-left: 0px solid; width: 0px; height: 1.123em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>A</mi><mo>?</mo><mi>N</mi></math></span></span><script type="math/tex" id="MathJax-Element-41">A-N</script></span>的路径已经在一个Splay中了，大功告成！<br>
代码其实很简单。。。。。。循环处理，只有四步——</p>
<ol>
<li>转到根；</li>
<li>换儿子；</li>
<li>更新信息；</li>
<li>当前操作点切换为轻边所指的父亲，转1</li>
</ol>
<pre class="cpp"><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">access</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> y=<span class="hljs-number">0</span>;x;y=x,x=f[x])
        splay(x),c[x][<span class="hljs-number">1</span>]=y,pushup(x);<span class="hljs-comment">//儿子变了，需要及时上传信息</span>
}</code></pre>
<h2 id="makerootx"><span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-42-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi><mi>a</mi><mi>k</mi><mi>e</mi><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-210" style="width: 6.92em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.506em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.509em, 1005.41em, 2.791em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-211"><span class="mi" id="MathJax-Span-212" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-213" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-214" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mi" id="MathJax-Span-215" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-216" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-217" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-218" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-219" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-220" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-221" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-222" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.371em; border-left: 0px solid; width: 0px; height: 1.368em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>k</mi><mi>e</mi><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-42">makeroot(x)</script></span></h2>
<p>只是把根到某个节点的路径拉起来并不能满足我们的需要。更多时候，我们要获取指定两个节点之间的路径信息。<br>
然而一定会出现路径不能满足按深度严格递增的要求的情况。根据性质1，这样的路径不能在一个Splay中。<br>
Then what can we do?<br>
<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-43-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi><mi>a</mi><mi>k</mi><mi>e</mi><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-223" style="width: 5.252em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.2em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.556em, 1004.17em, 2.561em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-224"><span class="mi" id="MathJax-Span-225" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-226" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-227" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mi" id="MathJax-Span-228" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-229" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-230" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-231" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-232" style="font-family: MathJax_Math; font-style: italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.006em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>k</mi><mi>e</mi><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-43">makeroot</script></span>定义为换根，让指定点成为原树的根。<br>
这时候就利用到<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-44-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-233" style="width: 5.202em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.15em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.5em, 1004.06em, 2.8em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-234"><span class="mi" id="MathJax-Span-235" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-236" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-237" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-238" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-239" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-240" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-241" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-242" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-243" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.375em; border-left: 0px solid; width: 0px; height: 1.375em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-44">access(x)</script></span>和Splay的翻转操作。<br>
<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-45-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-244" style="width: 5.202em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.15em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.5em, 1004.06em, 2.8em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-245"><span class="mi" id="MathJax-Span-246" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-247" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-248" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-249" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-250" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-251" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-252" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-253" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-254" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.375em; border-left: 0px solid; width: 0px; height: 1.375em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-45">access(x)</script></span>后<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-46-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-255" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.561em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-256"><span class="mi" id="MathJax-Span-257" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-46">x</script></span>在Splay中一定是深度最大的点对吧。<br>
<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-47-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-258" style="width: 4.603em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.65em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.5em, 1003.56em, 2.8em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-259"><span class="mi" id="MathJax-Span-260" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-261" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-262" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-263" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-264" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-265" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-266" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-267" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.375em; border-left: 0px solid; width: 0px; height: 1.375em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-47">splay(x)</script></span>后，<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-48-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-268" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.561em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-269"><span class="mi" id="MathJax-Span-270" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-48">x</script></span>在Splay中将没有右子树（性质1）。于是翻转整个Splay，使得所有点的深度都倒过来了，<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-49-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-271" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.561em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-272"><span class="mi" id="MathJax-Span-273" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-49">x</script></span>没了左子树，反倒成了深度最小的点（根节点），达到了我们的目的。<br>
代码</p>
<pre class="cpp"><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pushr</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{<span class="hljs-comment">//Splay区间翻转操作</span>
    swap(c[x][<span class="hljs-number">0</span>],c[x][<span class="hljs-number">1</span>]);
    r[x]^=<span class="hljs-number">1</span>;<span class="hljs-comment">//r为区间翻转懒标记数组</span>
}
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">makeroot</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{
    access(x);splay(x);
    pushr(x);
}</code></pre>
<p>关于pushdown和makeroot的一个相关的小问题详见下方update（关于pushdown的说明）</p>
<h2 id="findrootx"><span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-50-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>f</mi><mi>i</mi><mi>n</mi><mi>d</mi><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-274" style="width: 6.449em; display: inline-block;"><span style="display: inline-block; position: relative; width: 5.129em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.509em, 1005.03em, 2.791em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-275"><span class="mi" id="MathJax-Span-276" style="font-family: MathJax_Math; font-style: italic;">f<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.06em;"></span></span><span class="mi" id="MathJax-Span-277" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-278" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-279" style="font-family: MathJax_Math; font-style: italic;">d<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-280" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-281" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-282" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-283" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-284" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-285" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-286" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.371em; border-left: 0px solid; width: 0px; height: 1.368em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>f</mi><mi>i</mi><mi>n</mi><mi>d</mi><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-50">findroot(x)</script></span></h2>
<p>找<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-51-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-287" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.561em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-288"><span class="mi" id="MathJax-Span-289" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-51">x</script></span>所在原树的树根，主要用来判断两点之间的连通性（findroot(x)==findroot(y)表明<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-52-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>,</mo><mi>y</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-290" style="width: 1.902em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1001.5em, 2.755em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-291"><span class="mi" id="MathJax-Span-292" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-293" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-294" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 0.934em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>,</mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-52">x,y</script></span>在同一棵树中）<br>
代码：</p>
<pre class="cpp"><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findroot</span><span class="hljs-params">(R x)</span></span>{
    access(x); splay(x);
    <span class="hljs-keyword">while</span>(c[x][<span class="hljs-number">0</span>])pushdown(x),x=c[x][<span class="hljs-number">0</span>];
<span class="hljs-comment">//如要获得正确的原树树根，一定pushdown！详见下方update（关于findroot中pushdown的说明）</span>
    splay(x);<span class="hljs-comment">//此处的问题详见下方update（关于findroot中splay(x)的说明）</span>
    <span class="hljs-keyword">return</span> x;
}</code></pre>
<p>同样利用性质1，不停找左儿子，因为其深度一定比当前点深度小。</p>
<h2 id="splitxy"><span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-53-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-295" style="width: 5.367em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.282em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.509em, 1004.19em, 2.791em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-296"><span class="mi" id="MathJax-Span-297" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-298" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-299" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-300" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-301" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-302" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-303" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-304" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-305" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-306" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.371em; border-left: 0px solid; width: 0px; height: 1.368em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>p</mi><mi>l</mi><mi>i</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-53">split(x,y)</script></span></h2>
<p>神奇的<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-54-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>m</mi><mi>a</mi><mi>k</mi><mi>e</mi><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-307" style="width: 5.252em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.2em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.556em, 1004.17em, 2.561em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-308"><span class="mi" id="MathJax-Span-309" style="font-family: MathJax_Math; font-style: italic;">m</span><span class="mi" id="MathJax-Span-310" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-311" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mi" id="MathJax-Span-312" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-313" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-314" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-315" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-316" style="font-family: MathJax_Math; font-style: italic;">t</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 1.006em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>m</mi><mi>a</mi><mi>k</mi><mi>e</mi><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi></math></span></span><script type="math/tex" id="MathJax-Element-54">makeroot</script></span>已经出现，我们终于可以访问指定的一条在原树中的链啦！<br>
split(x,y)定义为拉出<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-55-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>&amp;#x2212;</mo><mi>y</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-317" style="width: 2.902em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.3em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.667em, 1002.3em, 2.755em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-318"><span class="mi" id="MathJax-Span-319" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-320" style="font-family: MathJax_Main; padding-left: 0.222em;">?</span><span class="mi" id="MathJax-Span-321" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 1.11em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>?</mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-55">x-y</script></span>的路径成为一个Splay（本蒟蒻以<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-56-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-322" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.755em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-323"><span class="mi" id="MathJax-Span-324" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 0.934em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-56">y</script></span>作为该Splay的根）<br>
代码</p>
<pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">split</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x,<span class="hljs-keyword">int</span> y)</span></span>{
    makeroot(x);
    access(y);splay(y);
}</code></pre>
<p>x成为了根，那么x到y的路径就可以用<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-57-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-325" style="width: 5.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.05em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.5em, 1003.96em, 2.8em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-326"><span class="mi" id="MathJax-Span-327" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-328" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-329" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-330" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-331" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-332" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-333" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-334" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-335" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.375em; border-left: 0px solid; width: 0px; height: 1.375em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-57">access(y)</script></span>直接拉出来了，将y转到Splay根后，我们就可以直接通过访问<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-58-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-336" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.755em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-337"><span class="mi" id="MathJax-Span-338" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 0.934em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-58">y</script></span>来获取该路径的有关信息</p>
<h2 id="linkxy"><span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-59-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-339" style="width: 5.085em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.047em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.509em, 1003.95em, 2.791em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-340"><span class="mi" id="MathJax-Span-341" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-342" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-343" style="font-family: MathJax_Math; font-style: italic;">n</span><span class="mi" id="MathJax-Span-344" style="font-family: MathJax_Math; font-style: italic;">k</span><span class="mo" id="MathJax-Span-345" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-346" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-347" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-348" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-349" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.371em; border-left: 0px solid; width: 0px; height: 1.368em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>l</mi><mi>i</mi><mi>n</mi><mi>k</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-59">link(x,y)</script></span></h2>
<p>连一条<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-60-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>&amp;#x2212;</mo><mi>y</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-350" style="width: 2.902em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.3em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.667em, 1002.3em, 2.755em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-351"><span class="mi" id="MathJax-Span-352" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-353" style="font-family: MathJax_Main; padding-left: 0.222em;">?</span><span class="mi" id="MathJax-Span-354" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 1.11em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>?</mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-60">x-y</script></span>的边（本蒟蒻使<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-61-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-355" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.561em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-356"><span class="mi" id="MathJax-Span-357" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-61">x</script></span>的父亲指向<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-62-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-358" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.755em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-359"><span class="mi" id="MathJax-Span-360" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 0.934em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-62">y</script></span>，连一条轻边）<br>
代码</p>
<pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">link</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x,<span class="hljs-keyword">int</span> y)</span></span>{
    makeroot(x);
    <span class="hljs-keyword">if</span>(findroot(y)==x)<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<span class="hljs-comment">//两点已经在同一子树中，再连边不合法</span>
    f[x]=y;
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
}</code></pre>
<p>如果题目保证连边合法，代码就可以更简单</p>
<pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">link</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x,<span class="hljs-keyword">int</span> y)</span></span>{
    makeroot(x);
    f[x]=y;
}</code></pre>
<h2 id="cutxy"><span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-63-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>c</mi><mi>u</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-361" style="width: 4.614em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.671em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.509em, 1003.58em, 2.791em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-362"><span class="mi" id="MathJax-Span-363" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-364" style="font-family: MathJax_Math; font-style: italic;">u</span><span class="mi" id="MathJax-Span-365" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-366" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-367" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-368" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-369" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-370" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.371em; border-left: 0px solid; width: 0px; height: 1.368em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>c</mi><mi>u</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mo>,</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-63">cut(x,y)</script></span></h2>
<p>将<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-64-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>&amp;#x2212;</mo><mi>y</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-371" style="width: 2.902em; display: inline-block;"><span style="display: inline-block; position: relative; width: 2.3em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.667em, 1002.3em, 2.755em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-372"><span class="mi" id="MathJax-Span-373" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-374" style="font-family: MathJax_Main; padding-left: 0.222em;">?</span><span class="mi" id="MathJax-Span-375" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.222em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 1.11em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>?</mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-64">x-y</script></span>的边断开。<br>
如果题目保证断边合法，倒是很方便。<br>
使<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-65-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-376" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.561em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-377"><span class="mi" id="MathJax-Span-378" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-65">x</script></span>为根后，<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-66-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-379" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.755em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-380"><span class="mi" id="MathJax-Span-381" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 0.934em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-66">y</script></span>的父亲一定指向<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-67-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-382" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.561em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-383"><span class="mi" id="MathJax-Span-384" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-67">x</script></span>，深度相差一定是<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-68-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>1</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-385" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.534em, 1000.43em, 2.5em, -1000em); top: -2.35em; left: 0em;"><span class="mrow" id="MathJax-Span-386"><span class="mn" id="MathJax-Span-387" style="font-family: MathJax_Main;">1</span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.958em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>1</mn></math></span></span><script type="math/tex" id="MathJax-Element-68">1</script></span>。当<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-69-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>s</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-388" style="width: 10.152em; display: inline-block;"><span style="display: inline-block; position: relative; width: 8.1em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.5em, 1008.01em, 2.8em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-389"><span class="mi" id="MathJax-Span-390" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-391" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-392" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-393" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-394" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-395" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-396" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-397" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-398" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-399" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-400" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">s</span><span class="mi" id="MathJax-Span-401" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-402" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-403" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-404" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-405" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-406" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-407" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.375em; border-left: 0px solid; width: 0px; height: 1.375em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo><mo>,</mo><mi>s</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-69">access(y),splay(y)</script></span>以后，<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-70-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-408" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.561em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-409"><span class="mi" id="MathJax-Span-410" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-70">x</script></span>一定是<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-71-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-411" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.755em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-412"><span class="mi" id="MathJax-Span-413" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 0.934em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-71">y</script></span>的左儿子，直接双向断开连接</p>
<pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">cut</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x,<span class="hljs-keyword">int</span> y)</span></span>{
    split(x,y);
    f[x]=c[y][<span class="hljs-number">0</span>]=<span class="hljs-number">0</span>;
    pushup(y);<span class="hljs-comment">//少了个儿子，也要上传一下</span>
}</code></pre>
<p>那如果不一定存在该边呢？<br>
充分利用好Splay和LCT的各种基本性质吧！<br>
正确姿势——先判一下连通性，再看看<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-72-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>,</mo><mi>y</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-414" style="width: 1.902em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1001.5em, 2.755em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-415"><span class="mi" id="MathJax-Span-416" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-417" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-418" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 0.934em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>,</mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-72">x,y</script></span>是否有父子关系，还要看<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-73-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-419" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.561em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-420"><span class="mi" id="MathJax-Span-421" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-73">x</script></span>是否有右儿子。<br>
因为<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-74-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-422" style="width: 5.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.05em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.5em, 1003.96em, 2.8em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-423"><span class="mi" id="MathJax-Span-424" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-425" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-426" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-427" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-428" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-429" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-430" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-431" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-432" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.375em; border-left: 0px solid; width: 0px; height: 1.375em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-74">access(y)</script></span>以后，假如y与x在同一Splay中而没有直接连边，那么这条路径上就一定会有其它点，在中序遍历序列中的位置会介于<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-75-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-433" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.561em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-434"><span class="mi" id="MathJax-Span-435" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-75">x</script></span>与<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-76-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-436" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.755em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-437"><span class="mi" id="MathJax-Span-438" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 0.934em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-76">y</script></span>之间。<br>
那么可能<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-77-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-439" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.561em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-440"><span class="mi" id="MathJax-Span-441" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-77">x</script></span>的父亲就不是<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-78-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-442" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.755em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-443"><span class="mi" id="MathJax-Span-444" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 0.934em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-78">y</script></span>了。<br>
也可能<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-79-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-445" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.561em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-446"><span class="mi" id="MathJax-Span-447" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-79">x</script></span>的父亲还是<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-80-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>y</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-448" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.755em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-449"><span class="mi" id="MathJax-Span-450" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 0.934em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-80">y</script></span>，那么其它的点就在<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-81-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-451" style="width: 0.703em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.55em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1000.5em, 2.561em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-452"><span class="mi" id="MathJax-Span-453" style="font-family: MathJax_Math; font-style: italic;">x</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.691em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi></math></span></span><script type="math/tex" id="MathJax-Element-81">x</script></span>的右子树中，就像这样<br>
<img src="https://images2018.cnblogs.com/blog/1309909/201803/1309909-20180311171742813-1632507362.jpg"></p>
<p>只有三个条件都满足，才可以断掉。</p>
<pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">cut</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x,<span class="hljs-keyword">int</span> y)</span></span>{
    makeroot(x);
    <span class="hljs-keyword">if</span>(findroot(y)!=x||f[x]!=y||c[x][<span class="hljs-number">1</span>])<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    f[x]=c[y][<span class="hljs-number">0</span>]=<span class="hljs-number">0</span>;
    pushup(y);
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
}</code></pre>
<p>如果维护了<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-82-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-454" style="width: 2.202em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.75em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.589em, 1001.71em, 2.561em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-455"><span class="mi" id="MathJax-Span-456" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-457" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-458" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-459" style="font-family: MathJax_Math; font-style: italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.965em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-82">size</script></span>，还可以换一种判断</p>
<pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">cut</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x,<span class="hljs-keyword">int</span> y)</span></span>{
    makeroot(x);
    <span class="hljs-keyword">if</span>(findroot(y)!=x&amp;&amp;sz[y]&gt;<span class="hljs-number">2</span>)<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
    f[x]=c[y][<span class="hljs-number">0</span>]=<span class="hljs-number">0</span>;
    pushup(y);
}</code></pre>
<p>解释一下，如果他们有直接连边的话，<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-83-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy=&quot;false&quot;>(</mo><mi>y</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-460" style="width: 5.103em; display: inline-block;"><span style="display: inline-block; position: relative; width: 4.05em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.5em, 1003.96em, 2.8em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-461"><span class="mi" id="MathJax-Span-462" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-463" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-464" style="font-family: MathJax_Math; font-style: italic;">c</span><span class="mi" id="MathJax-Span-465" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mi" id="MathJax-Span-466" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-467" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mo" id="MathJax-Span-468" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-469" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-470" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.375em; border-left: 0px solid; width: 0px; height: 1.375em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>a</mi><mi>c</mi><mi>c</mi><mi>e</mi><mi>s</mi><mi>s</mi><mo stretchy="false">(</mo><mi>y</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-83">access(y)</script></span>以后，为了满足性质1，该Splay只会剩下<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-84-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>x</mi><mo>,</mo><mi>y</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-471" style="width: 1.902em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.808em, 1001.5em, 2.755em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-472"><span class="mi" id="MathJax-Span-473" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-474" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-475" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.319em; border-left: 0px solid; width: 0px; height: 0.934em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>x</mi><mo>,</mo><mi>y</mi></math></span></span><script type="math/tex" id="MathJax-Element-84">x,y</script></span>两个点了。<br>
反过来说，如果有其它的点，<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-85-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-476" style="width: 2.202em; display: inline-block;"><span style="display: inline-block; position: relative; width: 1.75em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.589em, 1001.71em, 2.561em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-477"><span class="mi" id="MathJax-Span-478" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-479" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-480" style="font-family: MathJax_Math; font-style: italic;">z<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span class="mi" id="MathJax-Span-481" style="font-family: MathJax_Math; font-style: italic;">e</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.076em; border-left: 0px solid; width: 0px; height: 0.965em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>i</mi><mi>z</mi><mi>e</mi></math></span></span><script type="math/tex" id="MathJax-Element-85">size</script></span>不就大于<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-86-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mn>2</mn></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-482" style="width: 0.653em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.5em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.534em, 1000.45em, 2.5em, -1000em); top: -2.35em; left: 0em;"><span class="mrow" id="MathJax-Span-483"><span class="mn" id="MathJax-Span-484" style="font-family: MathJax_Main;">2</span></span><span style="display: inline-block; width: 0px; height: 2.35em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.063em; border-left: 0px solid; width: 0px; height: 0.958em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mn>2</mn></math></span></span><script type="math/tex" id="MathJax-Element-86">2</script></span>了么？</p>
<hr>
<p>其实，还有一些LCT中的Splay的操作，跟我们以往学习的纯Splay的某些操作细节不甚相同。<br>
包括<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-87-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>s</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>r</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo><mo>,</mo><mi>n</mi><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-485" style="width: 15.353em; display: inline-block;"><span style="display: inline-block; position: relative; width: 12.25em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.5em, 1012.16em, 2.8em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-486"><span class="mi" id="MathJax-Span-487" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-488" style="font-family: MathJax_Math; font-style: italic;">p</span><span class="mi" id="MathJax-Span-489" style="font-family: MathJax_Math; font-style: italic;">l</span><span class="mi" id="MathJax-Span-490" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-491" style="font-family: MathJax_Math; font-style: italic;">y<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.006em;"></span></span><span class="mo" id="MathJax-Span-492" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-493" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-494" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-495" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-496" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">r</span><span class="mi" id="MathJax-Span-497" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-498" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-499" style="font-family: MathJax_Math; font-style: italic;">a</span><span class="mi" id="MathJax-Span-500" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mi" id="MathJax-Span-501" style="font-family: MathJax_Math; font-style: italic;">e</span><span class="mo" id="MathJax-Span-502" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-503" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-504" style="font-family: MathJax_Main;">)</span><span class="mo" id="MathJax-Span-505" style="font-family: MathJax_Main;">,</span><span class="mi" id="MathJax-Span-506" style="font-family: MathJax_Math; font-style: italic; padding-left: 0.167em;">n</span><span class="mi" id="MathJax-Span-507" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-508" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-509" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-510" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-511" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-512" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-513" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.375em; border-left: 0px solid; width: 0px; height: 1.375em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>s</mi><mi>p</mi><mi>l</mi><mi>a</mi><mi>y</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>,</mo><mi>r</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>t</mi><mi>e</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>,</mo><mi>n</mi><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-87">splay(x),rotate(x),nroot(x)</script></span>（看到许多版本LCT写的是<span class="math inline"><span class="MathJax_Preview" style="color: inherit; display: none;"></span><span class="MathJax" id="MathJax-Element-88-Frame" tabindex="0" style="position: relative;" data-mathml="<math xmlns=&quot;http://www.w3.org/1998/Math/MathML&quot;><mi>i</mi><mi>s</mi><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy=&quot;false&quot;>(</mo><mi>x</mi><mo stretchy=&quot;false&quot;>)</mo></math>" role="presentation"><nobr aria-hidden="true"><span class="math" id="MathJax-Span-514" style="width: 4.952em; display: inline-block;"><span style="display: inline-block; position: relative; width: 3.95em; height: 0px; font-size: 125%;"><span style="position: absolute; clip: rect(1.5em, 1003.86em, 2.8em, -1000em); top: -2.4em; left: 0em;"><span class="mrow" id="MathJax-Span-515"><span class="mi" id="MathJax-Span-516" style="font-family: MathJax_Math; font-style: italic;">i</span><span class="mi" id="MathJax-Span-517" style="font-family: MathJax_Math; font-style: italic;">s</span><span class="mi" id="MathJax-Span-518" style="font-family: MathJax_Math; font-style: italic;">r</span><span class="mi" id="MathJax-Span-519" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-520" style="font-family: MathJax_Math; font-style: italic;">o</span><span class="mi" id="MathJax-Span-521" style="font-family: MathJax_Math; font-style: italic;">t</span><span class="mo" id="MathJax-Span-522" style="font-family: MathJax_Main;">(</span><span class="mi" id="MathJax-Span-523" style="font-family: MathJax_Math; font-style: italic;">x</span><span class="mo" id="MathJax-Span-524" style="font-family: MathJax_Main;">)</span></span><span style="display: inline-block; width: 0px; height: 2.4em;"></span></span></span><span style="display: inline-block; overflow: hidden; vertical-align: -0.375em; border-left: 0px solid; width: 0px; height: 1.375em;"></span></span></nobr><span class="MJX_Assistive_MathML" role="presentation"><math xmlns="http://www.w3.org/1998/Math/MathML"><mi>i</mi><mi>s</mi><mi>r</mi><mi>o</mi><mi>o</mi><mi>t</mi><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo></math></span></span><script type="math/tex" id="MathJax-Element-88">isroot(x)</script></span>，但我觉得反过来会方便些）<br>
这些区别之处详见下面的模板题注释。</p>
<h3 id="update关于findroot中pushdown的说明">update（关于findroot中pushdown的说明）</h3>
<p>蒟蒻真的一时没注意这个问题。。。。。。Splay根本没学好<br>
找根的时候，当然不能保证Splay中到根的路径上的翻转标记全放掉。<br>
所以最好把pushdown写上。<br>
<a href="https://www.cnblogs.com/candy99/p/6271344.html">Candy巨佬的总结</a>对pushdown问题有详细的分析<br>
只不过蒟蒻后来经常习惯这样判连通性（<del>我也不知道怎么养成的</del>）</p>
<pre class="cpp"><code class="hljs">makeroot(x);
<span class="hljs-keyword">if</span>(findroot(y)==x)<span class="hljs-comment">//后续省略</span></code></pre>
<p>这样好像没出过问题，那应该可以证明是没问题的（makeroot保证了x在LCT的顶端，access(y)+splay(y)以后，假如x,y在一个Splay里，那x到y的路径一定全部放完了标记）<br>
导致很久没有发现错误。。。。。。<br>
另外提一下，假如LCT题目在维护连通性的情况中只可能出现合并而不会出现分离的话，其实可以用并查集哦！（实践证明findroot很慢）<br>
这样的例子有不少，比如下面“维护链上的边权信息”部分的两道题都是的。<br>
甚至听到Julao们说有少量题目还专门卡这个细节。。。。。。<a href="https://www.zybuluo.com/xzyxzy/note/1027479">XZY巨佬的博客</a>就提到了（<del>我太弱啦，暂时并不会</del>）</p>
<h3 id="update关于pushdown的说明">update（关于pushdown的说明）</h3>
<p>我pushdown和makeroot有时候会这样写，常数小一点</p>
<pre class="cpp"><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">pushdown</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{
    <span class="hljs-keyword">if</span>(r[x]){
        r[x]=<span class="hljs-number">0</span>;
        <span class="hljs-keyword">int</span> t=c[x][<span class="hljs-number">0</span>];
        r[c[x][<span class="hljs-number">0</span>]=c[x][<span class="hljs-number">1</span>]]^=<span class="hljs-number">1</span>;
        r[c[x][<span class="hljs-number">1</span>]=t]^=<span class="hljs-number">1</span>;
    }
}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">makeroot</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{
    access(x);splay(x);
    r[x]^=<span class="hljs-number">1</span>;
}</code></pre>
<p>这种写法等于说当x有懒标记时，x的左右儿子还是反的<br>
<del>那么如果findroot里实在要写pushdown，那么这种pushdown就会出现问题</del>（参考评论区@ zjp_shadow巨佬的指正）<br>
<strong>再次update，蒟蒻发现这种问题还是可以避免的，若用这种pushdown，findroot可以写，这样写就好啦</strong></p>
<pre class="cpp"><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findroot</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{
    access(x);splay(x);
    pushdown(x);
    <span class="hljs-keyword">while</span>(lc)pushdown(x=lc);
    splay(x);
    <span class="hljs-keyword">return</span> x;
}</code></pre>
<p>所以此总结以及下面模板里的pushdown，常数大了一点点，却是更稳妥、严谨的写法</p>
<pre class="cpp"><code class="hljs"><span class="hljs-comment">//pushr同上方makeroot部分</span>
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">pushdown</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{
    <span class="hljs-keyword">if</span>(r[x]){
        <span class="hljs-keyword">if</span>(c[x][<span class="hljs-number">0</span>])pushr(c[x][<span class="hljs-number">0</span>]);<span class="hljs-comment">//copy自模板，然后发现if可以不写</span>
        <span class="hljs-keyword">if</span>(c[x][<span class="hljs-number">1</span>])pushr(c[x][<span class="hljs-number">1</span>]);
        r[x]=<span class="hljs-number">0</span>;
    }
}
<span class="hljs-function"><span class="hljs-keyword">void</span> <span class="hljs-title">makeroot</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{
    access(x);splay(x);
    pushr(x);<span class="hljs-comment">//可以看到两种写法造成makeroot都是不一样的</span>
}</code></pre>
<p>这种写法等于说当x有懒标记时，x的左右儿子已经放到正确的位置了，只是儿子的儿子还是反的<br>
那么这样就不会出问题啦<br>
两种写法差别还确实有点大呢<br>
当题目中维护的信息与左右儿子顺序有关的时候，pushdown如果用这种不严谨写法会是错的<br>
比如[NOI2005]维护数列（这是Splay题）和洛谷P3613 睡觉困难综合征</p>
<h3 id="update关于findroot中splayx的说明">update（关于findroot中splay(x)的说明）</h3>
<p>某位Julao指出findroot中在找到原树根后（此时x跳到了原树根）应splay(x)，伸展一下，Splay的特性，保证复杂度(好像牵涉到玄学的势能分析，蒟蒻什么也不会啊QvQ)<br>
非常正确的做法。于是本蒟蒻进行了更正，却忘记了进行验证。<br>
后来Destinies巨佬指出第8个点WA。<br>
经过验证之后发现，加上splay(x)以后，点的相对位置发生了变化，导致cut需要更改，更改如下：</p>
<pre class="cpp"><code class="hljs"><span class="hljs-function">I <span class="hljs-title">cut</span><span class="hljs-params">(R x,R y)</span></span>{<span class="hljs-comment">//断边</span>
    makeroot(x);
    <span class="hljs-keyword">if</span>(findroot(y)==x&amp;&amp;f[y]==x&amp;&amp;!c[y][<span class="hljs-number">0</span>]){
        f[y]=c[x][<span class="hljs-number">1</span>]=<span class="hljs-number">0</span>;<span class="hljs-comment">//x在findroot(y)后被转到了根</span>
        pushup(x);
    }
}</code></pre>
<p>为了避免频繁讨论、修改带来的繁琐，此总结不建议在此模板题里加上splay(x)<br>
因为确实很难找到卡掉不写splay(x)的代码的数据，而且可能带来一点常数。<br>
或许我大多数时候把splay写成单旋（没错就是HNOI2017那种）会比Zig、Zag双旋要快个十几分之一也是这样的道理吧。。。。。。<br>
但这不意味着就不用写了<br>
在比较关键的时候（比如比赛时）该写的总要写。<br>
不管是单旋，还是不splay(x)，都是很容易卡掉的。。。。。。<br>
相信Dalao们都能熟练地在很多种不同的写法中切换的</p>
<h1 id="模板">模板</h1>
<p><a href="https://www.luogu.org/problemnew/show/P3690">洛谷P3690 【模板】Link Cut Tree （动态树）（点击进入题目）</a><br>
最基本的LCT操作都在这里，也没有更多额外的复杂操作了，确实很模板。</p>
<pre><code class="hljs cpp"><span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;cstdio&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">include</span><span class="hljs-meta-string">&lt;cstdlib&gt;</span></span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> R register int</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> I inline void</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> lc c[x][0]</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> rc c[x][1]</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> G ch=getchar()</span>
<span class="hljs-meta">#<span class="hljs-meta-keyword">define</span> in(z) G;\
    while(ch&lt;<span class="hljs-string">'-'</span>)G;\
    z=ch&amp;15;G;\
    while(ch&gt;<span class="hljs-string">'-'</span>)z*=10,z+=ch&amp;15,G;</span>
<span class="hljs-keyword">const</span> <span class="hljs-keyword">int</span> N=<span class="hljs-number">300009</span>;
<span class="hljs-keyword">int</span> f[N],c[N][<span class="hljs-number">2</span>],v[N],s[N],st[N];
<span class="hljs-keyword">bool</span> r[N];
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">nroot</span><span class="hljs-params">(R x)</span></span>{<span class="hljs-comment">//判断节点是否为一个Splay的根（与普通Splay的区别1）</span>
    <span class="hljs-keyword">return</span> c[f[x]][<span class="hljs-number">0</span>]==x||c[f[x]][<span class="hljs-number">1</span>]==x;
}<span class="hljs-comment">//原理很简单，如果连的是轻边，他的父亲的儿子里没有它</span>
<span class="hljs-function">I <span class="hljs-title">pushup</span><span class="hljs-params">(R x)</span></span>{<span class="hljs-comment">//上传信息</span>
    s[x]=s[lc]^s[rc]^v[x];
}
<span class="hljs-function">I <span class="hljs-title">pushr</span><span class="hljs-params">(R x)</span></span>{R t=lc;lc=rc;rc=t;r[x]^=<span class="hljs-number">1</span>;}<span class="hljs-comment">//翻转操作</span>
<span class="hljs-function">I <span class="hljs-title">pushdown</span><span class="hljs-params">(R x)</span></span>{<span class="hljs-comment">//判断并释放懒标记</span>
    <span class="hljs-keyword">if</span>(r[x]){
        <span class="hljs-keyword">if</span>(lc)pushr(lc);
        <span class="hljs-keyword">if</span>(rc)pushr(rc);
        r[x]=<span class="hljs-number">0</span>;
    }
}
<span class="hljs-function">I <span class="hljs-title">rotate</span><span class="hljs-params">(R x)</span></span>{<span class="hljs-comment">//一次旋转</span>
    R y=f[x],z=f[y],k=c[y][<span class="hljs-number">1</span>]==x,w=c[x][!k];
    <span class="hljs-keyword">if</span>(nroot(y))c[z][c[z][<span class="hljs-number">1</span>]==y]=x;c[x][!k]=y;c[y][k]=w;<span class="hljs-comment">//额外注意if(nroot(y))语句，此处不判断会引起致命错误（与普通Splay的区别2）</span>
    <span class="hljs-keyword">if</span>(w)f[w]=y;f[y]=x;f[x]=z;
    pushup(y);
}
<span class="hljs-function">I <span class="hljs-title">splay</span><span class="hljs-params">(R x)</span></span>{<span class="hljs-comment">//只传了一个参数，因为所有操作的目标都是该Splay的根（与普通Splay的区别3）</span>
    R y=x,z=<span class="hljs-number">0</span>;
    st[++z]=y;<span class="hljs-comment">//st为栈，暂存当前点到根的整条路径，pushdown时一定要从上往下放标记（与普通Splay的区别4）</span>
    <span class="hljs-keyword">while</span>(nroot(y))st[++z]=y=f[y];
    <span class="hljs-keyword">while</span>(z)pushdown(st[z--]);
<span class="hljs-comment">/*当然了，其实利用函数堆栈也很方便，代替上面几行手动栈，就像这样
I pushall(R x){
    if(nroot(x))pushall(f[x]);
    pushdown(x);
}*/</span>
    <span class="hljs-keyword">while</span>(nroot(x)){
        y=f[x];z=f[y];
        <span class="hljs-keyword">if</span>(nroot(y))
            rotate((c[y][<span class="hljs-number">0</span>]==x)^(c[z][<span class="hljs-number">0</span>]==y)?x:y);
        rotate(x);
    }
    pushup(x);
}
<span class="hljs-function">I <span class="hljs-title">access</span><span class="hljs-params">(R x)</span></span>{<span class="hljs-comment">//访问</span>
    <span class="hljs-keyword">for</span>(R y=<span class="hljs-number">0</span>;x;x=f[y=x])
        splay(x),rc=y,pushup(x);
}
<span class="hljs-function">I <span class="hljs-title">makeroot</span><span class="hljs-params">(R x)</span></span>{<span class="hljs-comment">//换根</span>
    access(x);splay(x);
    pushr(x);
}
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">int</span> <span class="hljs-title">findroot</span><span class="hljs-params">(R x)</span></span>{<span class="hljs-comment">//找根（在真实的树中的）</span>
    access(x);splay(x);
    <span class="hljs-keyword">while</span>(lc)pushdown(x),x=lc;
    <span class="hljs-comment">//splay(x);（在本模板中建议不写）</span>
    <span class="hljs-keyword">return</span> x;
}
<span class="hljs-function">I <span class="hljs-title">split</span><span class="hljs-params">(R x,R y)</span></span>{<span class="hljs-comment">//提取路径</span>
    makeroot(x);
    access(y);splay(y);
}
<span class="hljs-function">I <span class="hljs-title">link</span><span class="hljs-params">(R x,R y)</span></span>{<span class="hljs-comment">//连边</span>
    makeroot(x);
    <span class="hljs-keyword">if</span>(findroot(y)!=x)f[x]=y;
}
<span class="hljs-function">I <span class="hljs-title">cut</span><span class="hljs-params">(R x,R y)</span></span>{<span class="hljs-comment">//断边</span>
    makeroot(x);
    <span class="hljs-keyword">if</span>(findroot(y)==x&amp;&amp;f[x]==y&amp;&amp;!rc)){
        f[x]=c[y][<span class="hljs-number">0</span>]=<span class="hljs-number">0</span>;
        pushup(y);
    }
}
<span class="hljs-function"><span class="hljs-keyword">int</span> <span class="hljs-title">main</span><span class="hljs-params">()</span>
</span>{
    <span class="hljs-keyword">register</span> <span class="hljs-keyword">char</span> ch;
    R n,m,i,type,x,y;
    in(n);in(m);
    <span class="hljs-keyword">for</span>(i=<span class="hljs-number">1</span>;i&lt;=n;++i){in(v[i]);}
    <span class="hljs-keyword">while</span>(m--){
        in(type);in(x);in(y);
        <span class="hljs-keyword">switch</span>(type){
        <span class="hljs-keyword">case</span> <span class="hljs-number">0</span>:split(x,y);<span class="hljs-built_in">printf</span>(<span class="hljs-string">"%d\n"</span>,s[y]);<span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">1</span>:link(x,y);<span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">2</span>:cut(x,y);<span class="hljs-keyword">break</span>;
        <span class="hljs-keyword">case</span> <span class="hljs-number">3</span>:splay(x);v[x]=y;<span class="hljs-comment">//先把x转上去再改，不然会影响Splay信息的正确性</span>
        }
    }
    <span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;
}</code></pre>
<h1 id="题单">题单</h1>
<p>灰常感谢XZY巨佬提供的强力资磁！（可参考<a href="https://www.zybuluo.com/xzyxzy/note/1027479">XZY巨佬的博客总结</a>）<br>
题单对于系统地学习一个知识点还是有好处的。<br>
所以蒟蒻搜集了各处的LCT题目（其实作为近年新兴的知识点，现有的好题不是很多，<del>有些题树剖也可做</del>）<br>
大概按细化分类进行整理（类比下面的几个细化知识点，会有重复的列举）<br>
同一类中的题目也大概按难度递增吧（太弱了，对每个题的难度定位或许有不准的地方，欢迎讨论！）</p>
<h2 id="维护链信息lct上的平衡树操作">维护链信息（LCT上的平衡树操作）</h2>
<ul>
<li>【Done】<a href="https://www.luogu.org/problemnew/show/P3690">洛谷P3690 【模板】Link Cut Tree</a></li>
<li>【Todo】<a href="https://www.luogu.org/problemnew/show/SP913">洛谷SP913 QTREE2 - Query on a tree II</a>（其实明明可以倍增）</li>
<li>【<a href="http://www.cnblogs.com/flashhu/p/8349984.html">Sol.</a>】<a href="https://www.luogu.org/problemnew/show/P3203">洛谷P3203 [HNOI2010]弹飞绵羊</a></li>
<li>【<a href="http://www.cnblogs.com/flashhu/p/8343609.html">Sol.</a>】<a href="https://www.luogu.org/problemnew/show/P1501">洛谷P1501 [国家集训队]Tree II</a></li>
<li>【Todo】<a href="https://www.luogu.org/problemnew/show/P2486">洛谷P2486 [SDOI2011]染色</a></li>
</ul>
<h2 id="动态维护连通性双联通分量可以说是并查集的升级因为并查集只能连不能断">动态维护连通性&amp;双联通分量（可以说是并查集的升级，因为并查集只能连不能断）</h2>
<ul>
<li>【Done】 <a href="https://www.luogu.org/problemnew/show/P2147">洛谷P2147 [SDOI2008]Cave 洞穴勘测</a></li>
<li>【<a href="http://www.cnblogs.com/flashhu/p/8653506.html">Sol.</a>】 <a href="https://www.luogu.org/problemnew/show/P3950">洛谷P3950 部落冲突</a></li>
<li>【<a href="http://www.cnblogs.com/flashhu/p/8653543.html">Sol.</a>】 <a href="https://www.luogu.org/problemnew/show/P2542">洛谷P2542 [AHOI2005]航线规划</a></li>
<li>【Done】 <a href="http://www.lydsy.com/JudgeOnline/problem.php?id=4998">BZOJ4998 星球联盟</a></li>
<li>【Done】 <a href="http://www.lydsy.com/JudgeOnline/problem.php?id=2959">BZOJ2959 长跑</a></li>
</ul>
<h2 id="维护边权常用于维护生成树">维护边权（常用于维护生成树）</h2>
<ul>
<li>【<a href="http://www.cnblogs.com/flashhu/p/8590847.html">Sol.</a>】<a href="https://www.luogu.org/problemnew/show/P4172">洛谷P4172 [WC2006]水管局长</a></li>
<li>【Todo】<a href="http://uoj.ac/problem/274">UOJ274温暖会指引我们前行</a></li>
<li>【<a href="http://www.cnblogs.com/flashhu/p/8430966.html">Sol.</a>】<a href="https://www.luogu.org/problemnew/show/P4180">洛谷P4180 [BJWC2010]次小生成树</a></li>
<li>【<a href="http://www.cnblogs.com/flashhu/p/8576460.html">Sol.</a>】<a href="https://www.luogu.org/problemnew/show/P4234">洛谷P4234 最小差值生成树</a></li>
<li>【<a href="http://www.cnblogs.com/flashhu/p/8460043.html">Sol.</a>】<a href="https://www.luogu.org/problemnew/show/P2387">洛谷P2387 [NOI2014]魔法森林</a></li>
</ul>
<h2 id="维护子树信息">维护子树信息</h2>
<ul>
<li>【Done】<a href="http://cogs.pro:8080/cogs/problem/problem.php?pid=2701">[COGS2701]动态树</a></li>
<li>【<a href="http://www.cnblogs.com/flashhu/p/8423326.html">Sol.</a>】<a href="https://www.luogu.org/problemnew/show/P4219">洛谷P4219 [BJOI2014]大融合</a></li>
<li>【<a href="http://www.cnblogs.com/flashhu/p/8423974.html">Sol.</a>】<a href="https://www.luogu.org/problemnew/show/U19464">洛谷U19464 山村游历(Wander)</a></li>
<li>【<a href="http://www.cnblogs.com/flashhu/p/8626003.html">Sol.</a>】<a href="https://www.luogu.org/problemnew/show/U21715">洛谷U21715 首都</a>（BZOJ3510权限题qwq）</li>
<li>【Todo】<a href="https://www.luogu.org/problemnew/show/SP2939">洛谷SP2939 QTREE5 - Query on a tree V</a></li>
</ul>
<h2 id="维护树上染色联通块">维护树上染色联通块</h2>
<ul>
<li>【Todo】<a href="https://www.luogu.org/problemnew/show/P2173">洛谷P2173 [ZJOI2012]网络</a></li>
<li>【<a href="http://www.cnblogs.com/flashhu/p/8558695.html">Sol.</a>】<a href="https://www.luogu.org/problemnew/show/P3703">洛谷P3703 [SDOI2017]树点涂色</a></li>
<li>【<a href="http://www.cnblogs.com/flashhu/p/8635282.html">Sol.</a>】<a href="https://www.luogu.org/problemnew/show/SP16549">洛谷SP16549 QTREE6 - Query on a tree VI</a></li>
<li>【<a href="http://www.cnblogs.com/flashhu/p/8640576.html">Sol.</a>】<a href="https://www.luogu.org/problemnew/show/SP16580">洛谷SP16580 QTREE7 - Query on a tree VII</a></li>
<li>【Todo】<a href="http://www.lydsy.com/JudgeOnline/problem.php?id=3914">BZOJ3914 Jabby's shadows</a></li>
</ul>
<h2 id="特殊题型">特殊题型</h2>
<ul>
<li>【<a href="http://www.cnblogs.com/flashhu/p/8694346.html">Sol.</a>】<a href="https://www.luogu.org/problemnew/show/P3613">洛谷P3613 睡觉困难综合征</a></li>
<li>【Todo】<a href="http://uoj.ac/problem/207">UOJ207 共价大爷游长沙</a></li>
<li>【<a href="http://www.cnblogs.com/flashhu/p/8718951.html">Sol.</a>】<a href="https://www.luogu.org/problemnew/show/P3348">洛谷P3348 [ZJOI2016]大森林</a></li>
<li>【<a href="http://www.cnblogs.com/flashhu/p/8709637.html">Sol.</a>】<a href="https://www.luogu.org/problemnew/show/P4338">洛谷P4338 [ZJOI2018]历史</a></li>
<li>【Todo】<a href="https://loj.ac/problem/2289">LOJ2289 [THUWC 2017]在美妙的数学王国中畅游</a>（数学对于我这种蒟蒻是不可做的TAT）</li>
</ul>
<h1 id="操作升级模板以外的细化总结">操作升级！（模板以外的细化总结）</h1>
<h2 id="维护链信息lct上的平衡树操作-1">维护链信息（LCT上的平衡树操作）</h2>
<p>思路与模板基本都很像了，就不展开讨论了</p>
<h3 id="例题1">例题1</h3>
<p><a href="https://www.luogu.org/problemnew/show/P1501">洛谷P1501 [国家集训队]Tree II(点击进入题目）</a><br>
<del>感觉难度评定也高了点吧</del><br>
有了链上乘法和链上加法，那肯定是像线段树区间修改那样使用懒标记了。<br>
放标记的做法来自<a href="https://www.luogu.org/problemnew/show/P3373">[模板]线段树2</a><br>
那里发题解的Dalao们都讲得挺好的，本蒟蒻参考一下。<br>
<a href="http://www.cnblogs.com/flashhu/p/8343609.html">蒟蒻的题解在这里</a></p>
<h3 id="例题2">例题2</h3>
<p><a href="https://www.luogu.org/problemnew/show/P3203">洛谷P3203 [HNOI2010]弹飞绵羊（点击进入题目）</a><br>
略带一点思维，但是代码比模板还简单。。。。。。<br>
在LCT模板基础上进行灵活运用，可以使代码和程序都做到高效。<br>
<a href="http://www.cnblogs.com/flashhu/p/8349984.html">蒟蒻的题解在这里</a></p>
<h2 id="动态维护连通性双联通分量">动态维护连通性&amp;双联通分量</h2>
<p>维护连通性？findroot判一下就好啦！属于模板范畴<br>
至于双连通分量，LCT好像只能资磁加边。。。。。。<br>
LCT中的每个点其实代表的是一个双连通分量，维护每个点属于哪个双连通分量需要在外面弄一个并查集维护。<br>
加边时，如果两点不连通就link；<br>
如果连通就说明有环，把环缩成一个点，在并查集里也全部合并在一起<br>
其中要注意很多细节，具体就看下下面例题2的代码吧</p>
<h3 id="例题1-1">例题1</h3>
<p><a href="https://www.luogu.org/problemnew/show/P3950">洛谷P3950 部落冲突</a>（点击进入题目）<br>
正解不是LCT。。。。。。<br>
只是这里用LCT的思路非常简单甚至于无脑。。。。。。<br>
<a href="http://www.cnblogs.com/flashhu/p/8653506.html">蒟蒻题解</a></p>
<h3 id="例题2-1">例题2</h3>
<p><a href="https://www.luogu.org/problemnew/show/P2542">洛谷P2542 [AHOI2005]航线规划</a>（点击进入题目）<br>
基础的动态维护双连通分量，具体就看看题解吧<br>
<a href="http://www.cnblogs.com/flashhu/p/8653543.html">蒟蒻题解</a></p>
<h2 id="维护链上的边权信息生成树">维护链上的边权信息（生成树）</h2>
<p>普通LCT维护点权，那对于边权呢？比如要获取一条路径上最长的边，等等。<br>
这种维护的最经典的应用，大概就是动态维护一颗最小/大生成树了（需要获取边长度等信息）。<br>
我起初有一种想法。<br>
一棵树，除了根节点，每个节点有且仅有一条父边。<br>
那么如果我们只要边的信息，可不可以就把LCT中的点的点权当成父边的边权呢？<br>
在其它不少数据结构中好像是可以这样做的。<br>
只不过LCT性质非常特殊。一旦换了根，原先边的父子关系就破坏了。所以并不能这样做。<br>
那又如何是好呢？<br>
我在网上看到有些博客介绍的方法，是把边置于LCT外，然后在LCT节点中维护父边和重子边的编号，需要更新信息时从外部获取，在access，link，cut时额外更改。<br>
这样好像挺麻烦的，要维护那么多东西。<br>
另一种更抽象的做法，也是我要分享的，就是两个字——拆边，把边视作为一个点，向该边的两个端点连两条边。<br>
只需要维护边权的时候，边权存在LCT中代表边的点权里，因为不需要维护真正的点权，所以LCT中的代表点的点权可以设成空的（0），不会影响信息的正确性。于是就变成了维护点权。<br>
当然了，原先我们的link和cut是对于两个点的，现在有点不一样了（因为两点之间又多了一个代表边的点），写法就视具体需要来分析啦！<br>
比如，截取了下面例题二的非正常link与cut部分</p>
<pre><code class="hljs cpp"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">link</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{
    <span class="hljs-keyword">int</span> y=e[x].u,z=e[x].v;
    mroot(z);
    f[f[z]=x]=y;
}
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">cut</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{
    access(e[x].v);splay(x);
    lc=rc=f[lc]=f[rc]=<span class="hljs-number">0</span>;
    pushup(x);
}</code></pre>
<p>当然可以两遍link、cut啦，代码简单，不过有些操作浪费了，牺牲了一点常数。<br>
题目做得还不够，因此写法也不够成熟，还望Dalao们指教。</p>
<h3 id="例题一">例题一</h3>
<p><a href="https://www.luogu.org/problemnew/show/P4180">洛谷P4180 [BJWC2010]次小生成树</a><br>
其实这道题用LCT不是正解，不过是可做的（update：我后来又写了LCT），放在这里一下吧。<br>
用LCT维护最小生成树，再去枚举非树边尝试替换树边，更新最优答案。<br>
TPLY巨佬也用LCT做的（某问题导致常数巨大？），<a href="http://www.cnblogs.com/tply/p/8423955.html">他的题解在这里</a><br>
<a href="http://www.cnblogs.com/flashhu/p/8430966.html">蒟蒻题解在这里</a></p>
<h3 id="例题二">例题二</h3>
<p><a href="https://www.luogu.org/problemnew/show/P2387">洛谷P2387 [NOI2014]魔法森林</a><br>
我太弱啦！这种双关键字的维护我是真的没有思路，边看着题解边打出来的。orz XZY&amp;XZZ两位巨佬，题解点赞！<br>
不过作为LCT维护边权的好题目还是值得分享。<br>
<a href="http://www.cnblogs.com/flashhu/p/8460043.html">蒟蒻题解在这里</a></p>
<h2 id="维护虚子树信息总和与原树信息总和">维护虚子树信息总和与原树信息总和</h2>
<p>有时候，我们需要的并不是维护链的信息，而是子树的信息。要知道，LCT是长于维护链的信息，而弱于维护子树信息（这方面不得不承认树剖的用处了，还要赶紧学）。然而动态的连边和断边，又不得不要求我们使用LCT来维护。</p>
<p>其实，我们还是不会束手无策的。</p>
<p>维护子树信息总和的一些常见题型，无非就是询问整棵（原树中的）子树的总大小、权值总和、最值之类的东西。<br>
我们已经可以通过辅助树Splay来获知Splay中的实子树（也就是原树中的一条链）的信息总和。<br>
既然原树的边只有实与虚，子树也只有实与虚，那么如果要想维护好原树的信息总和，我们是不是首先要知道虚子树的信息总和？<br>
注：以下设<strong>虚子树信息总和用数组si表示，原树信息总和用s表示</strong>。此处si[x]只包含x所有虚子树（通过轻边指向x）的信息总和，而s[x]实际上是在LCT中的所有儿子的信息总和（包括辅助树Splay中相对的左右儿子的总和与被轻边所指的绝对的虚子树的总和）。<br>
那么如果我们确定了si[x]的值，是不是就知道了s[x]的值了？实加虚嘛！<br>
这就是pushup，代码</p>
<pre class="cpp"><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">pushup</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{
    s[x]=s[c[x][<span class="hljs-number">0</span>]]+s[c[x][<span class="hljs-number">1</span>]]+si[x]+<span class="hljs-number">1</span>;<span class="hljs-comment">//大小总和，注意别漏了+1，自己也要算上</span>
    <span class="hljs-comment">//或者</span>
    s[x]=s[c[x][<span class="hljs-number">0</span>]]+s[c[x][<span class="hljs-number">1</span>]]+si[x]+v[x];<span class="hljs-comment">//权值总和，自己同样也要算上</span>
}</code></pre>
<p>先不对这种方法是怎样来的这个问题追本溯源，那我们就可以直接考虑si如何维护了。<br>
还是直接假设我们已经提前维护好了si吧。<br>
很显然，si的变化取决于虚实边的变化，所以现在我们只考虑LCT中的每个操作会对虚实边产生怎样的影响。</p>
<ul>
<li>splay(x):显然这一操作只会改变节点在辅助树Splay中的相对位置，并不会对树中的虚子树信息产生任何影响。过程中的pushup会正确地更新s。</li>
<li>access(x):这个时候，我们发现，循环中每一次splay(x)后，我们更改了x的右子树，也就是更改了虚实边，那么会对信息产生影响。<br>
这里的影响，无非就是得到了一个虚儿子，失去了一个虚儿子，总和没有改变。<br>
于是直接改就好啦，si加上原来右儿子的s，再减去新的右儿子的s。<br>
与原模板略有不同的代码</li>
</ul>
<pre class="cpp"><code class="hljs"><span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">access</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x)</span></span>{
    <span class="hljs-keyword">for</span>(<span class="hljs-keyword">int</span> y=<span class="hljs-number">0</span>;x;x=f[y=x]){
        splay(x);
        si[x]+=s[c[x][<span class="hljs-number">1</span>]];
        si[x]-=s[c[x][<span class="hljs-number">1</span>]=y];
        pushup(x);
<span class="hljs-comment">//如果pushup只是更新原树信息总和s的话，甚至这里可以不写，毕竟加一个减一个，和没变</span>
    }
}</code></pre>
<ul>
<li>makeroot(x):并无影响。</li>
<li>findroot(x):显然无影响（跳左儿子又没改变树的形态）</li>
<li>split(x,y):显然无影响（除了调用三个函数外什么都没干）</li>
<li>link(x,y):这就有影响了。y多了一个轻边指向儿子x，那么s[y]，si[y]都加上s[x]。注意，多了一个子树，那么y在LCT中的祖先的s也都要加上s[x]的值。这样在加上s[x]前，还不如额外地把y转到根（access(y)+splay(y)），y就没有祖先了，再加，也不会影响信息的正确性。<br>
与原模板略有不同的代码</li>
</ul>
<pre class="cpp"><code class="hljs"><span class="hljs-comment">//保证连边合法</span>
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">void</span> <span class="hljs-title">link</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x,<span class="hljs-keyword">int</span> y)</span></span>{
    split(x,y);<span class="hljs-comment">//这里不是提取x-y的路径的意思，是makeroot+access+splay的偷懒写法</span>
    si[f[x]=y]+=s[x];
    pushup(y);
}
<span class="hljs-comment">//不保证</span>
<span class="hljs-function"><span class="hljs-keyword">inline</span> <span class="hljs-keyword">bool</span> <span class="hljs-title">link</span><span class="hljs-params">(<span class="hljs-keyword">int</span> x,<span class="hljs-keyword">int</span> y)</span></span>{
    makeroot(x);
    <span class="hljs-keyword">if</span>(findroot(y)==x)<span class="hljs-keyword">return</span> <span class="hljs-number">0</span>;<span class="hljs-comment">//access+splay已完成</span>
    si[f[x]=y]+=s[x];
    pushup(y);
    <span class="hljs-keyword">return</span> <span class="hljs-number">1</span>;
}</code></pre>
<ul>
<li>cut(x,y):无影响，断掉的是一条重边，pushup(y)更新s[y]就好啦。</li>
</ul>
<p>分析到此完毕。<del>其实好像也就只改了一点点地方。。。。。。</del>不过思路是很巧妙的，值得用心体会。</p>
<p>补充一句，如果要维护子树里的最值，一个套路是在每个节点开一个平衡树维护该节点所有虚子树的最值，以便进行查询和更改。</p>
<h3 id="例题一-1">例题一</h3>
<p><a href="https://www.luogu.org/problemnew/show/P4219">洛谷P4219 [BJOI2014]大融合（点击进入题目）</a><br>
当学会了LCT维护子树信息和以后，这题就变得有些裸了。。。。。。<br>
<a href="http://www.cnblogs.com/flashhu/p/8423326.html">蒟蒻题解在这里</a></p>
<h3 id="例题二-1">例题二</h3>
<p><a href="https://www.luogu.org/problemnew/show/U19464">洛谷U19464 山村游历(Wander)（点击进入题目）</a><br>
注：此题为WC模拟赛试题，版权归出题人Philipsweng所有。小蒟蒻觉得这题出得很不错，于是上传至洛谷个人题库，作为例题与大家分享。数据自测，如有问题欢迎反馈。<br>
题目简述：<br>
<del>没有。。。。。。这是一个阅读题，简述的话就等于告诉你怎么做了</del><br>
仔细读一下题目吧，这道题水平挺高的。<br>
思路分析：<br>
<del>也有点复杂</del><br>
然而分析完了以后，又变成裸的了。。。。。。<br>
算了，还是单独建一篇随笔吧。<br>
<a href="http://www.cnblogs.com/flashhu/p/8423974.html">蒟蒻题解在这里</a></p>
<h2 id="维护树上染色联通块-1">维护树上染色联通块</h2>
<p>维护方法要视具体情况分析<br>
可能可以开一个LCT然后把同色的点连起来，这样做思路很简单，但实现起来受局限<br>
也可能有多少颜色就开多少个LCT，然后在对应颜色的LCT中连上<br>
升级操作：修改点的颜色<br>
需要转化模型，可参考下面例题2<br>
再次升级操作：修改链为同一种颜色<br>
Link-Cut-Memphis（雾<br>
看一下发明者<a href="http://memphis.is-programmer.com/2015/8/7/linkcutmemphis.99293.html">Memphis巨佬的博客</a>吧<br>
以上两种操作都是在ZJOI2018交流课上听到的Orz</p>
<h3 id="例题一-2">例题一</h3>
<p><a href="https://www.luogu.org/problemnew/show/P3703">洛谷P3703 [SDOI2017]树点涂色</a>（点击进入题目）<br>
维护连通块并不麻烦，只是思维难度超大。。。。。。<br>
不会树剖，焉知非福？<br>
<a href="http://www.cnblogs.com/flashhu/p/8558695.html">蒟蒻的题解</a></p>
<h3 id="例题二-2">例题二</h3>
<p><a href="https://www.luogu.org/problemnew/show/SP16549">洛谷SP16549 QTREE6 - Query on a tree VI</a>（点击进入题目）<br>
一直都把边化为子节点，这次来把点化为父边（雾<br>
<a href="http://www.cnblogs.com/flashhu/p/8635282.html">蒟蒻的题解</a></p>
<h2 id="特殊题型-1">特殊题型</h2>
<p>有一类题目是真的毒瘤，怪异到都几乎认不出它的真面目<br>
似乎并不能把它们归为任何一类LCT题型或者任何一种套路<br>
只好仔细分析题目，发现题目本身的特殊性，再转化为LCT模型解决<br>
然而我什么都分析不出来啊QwQ</p>
<h3 id="例题一-3">例题一</h3>
<p><a href="https://www.luogu.org/problemnew/show/P3613">洛谷P3613 睡觉困难综合征</a><br>
把起床困难综合症——一个按位贪心的题目，完美地套在了LCT中<br>
<a href="http://www.cnblogs.com/flashhu/p/8694346.html">蒟蒻题解</a></p>
<h3 id="例题二-3">例题二</h3>
<p><a href="https://www.luogu.org/problemnew/show/P3348">洛谷P3348 [ZJOI2016]大森林</a><br>
新技能get：虚点<br>
离线的转移思路也极为巧妙<br>
<a href="http://www.cnblogs.com/flashhu/p/8718951.html">蒟蒻题解</a></p>
<h3 id="例题三">例题三</h3>
<p><a href="https://www.luogu.org/problemnew/show/P4338">洛谷P4338 [ZJOI2018]历史</a><br>
ZJOI唯一可做题TAT<br>
不来一些大力结论，根本做不下去。。。。。。<br>
<a href="http://www.cnblogs.com/flashhu/p/8709637.html">蒟蒻题解</a></p>
<h2 id="更多操作持续更新中">更多操作，持续更新中。。。。。。</h2>